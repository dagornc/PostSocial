<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Bouton de G√©n√©ration LinkedINPost</title>
    
    <!-- Styles de base -->
    <link rel="stylesheet" href="design-fixes.css">
    <link rel="stylesheet" href="accessibility-fixes.css">
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            background: #f8f9fa;
        }
        
        .test-section h2 {
            color: #0077b5;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .required {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .field-help {
            font-size: 13px;
            color: #495057;
            margin-top: 6px;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #0077b5;
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #0077b5 0%, #00a0dc 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-height: 56px;
            width: 100%;
            max-width: 400px;
            margin: 20px auto;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 119, 181, 0.4);
        }
        
        .generate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 119, 181, 0.6);
        }
        
        .generate-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.7;
        }
        
        .generate-btn.loading-state {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            cursor: wait;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ffffff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .test-results {
            background: #e8f5e8;
            border: 1px solid #27ae60;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .test-results h3 {
            color: #27ae60;
            margin-top: 0;
        }
        
        .test-item {
            margin: 10px 0;
            padding: 8px;
            border-radius: 4px;
            background: white;
        }
        
        .test-item.success {
            background: #d4edda;
            border-left: 4px solid #27ae60;
        }
        
        .test-item.error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        
        .test-item.warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        
        .accessibility-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .accessibility-info h3 {
            color: #2196f3;
            margin-top: 0;
        }
        
        .debug-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .icon {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test du Bouton de G√©n√©ration</h1>
        
        <div class="accessibility-info">
            <h3>üìã Objectif du Test</h3>
            <p>Ce test v√©rifie le bon fonctionnement du bouton "G√©n√©rer le post LinkedIn" et identifie les probl√®mes potentiels.</p>
        </div>
        
        <div class="test-section">
            <h2>üîß Formulaire de Test</h2>
            
            <form id="testForm" novalidate>
                <div class="form-group">
                    <label for="testSubject" id="testSubjectLabel">
                        Sujet du post <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <textarea id="testSubject" name="subject" required 
                             rows="3" 
                             placeholder="D√©crivez le sujet de votre post LinkedIn en quelques lignes..."
                             aria-describedby="testSubject-help"
                             aria-required="true"
                             aria-invalid="false"
                             aria-label="Zone de texte pour d√©crire le sujet de votre post LinkedIn"
                             tabindex="0"
                             autocomplete="off"
                             spellcheck="true">Test de g√©n√©ration de post LinkedIn pour v√©rifier le bon fonctionnement du bouton et identifier les probl√®mes potentiels</textarea>
                    <div id="testSubject-help" class="field-help" role="tooltip" aria-hidden="false">
                        Par exemple : votre expertise, une r√©flexion professionnelle, une actualit√© de votre secteur, etc.
                    </div>
                </div>

                <div class="form-group">
                    <label for="testAudience" id="testAudienceLabel">
                        Audience cible <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <select id="testAudience" name="audience" required 
                            aria-describedby="testAudience-help"
                            aria-required="true"
                            aria-invalid="false"
                            aria-label="Menu d√©roulant pour s√©lectionner l'audience cible"
                            tabindex="0">
                        <option value="" aria-label="Option par d√©faut - Choisir une audience">Choisir une audience...</option>
                        <option value="professionals" aria-label="Professionnels exp√©riment√©s" selected>Professionnels exp√©riment√©s</option>
                        <option value="juniors" aria-label="Jeunes professionnels">Jeunes professionnels</option>
                        <option value="entrepreneurs" aria-label="Entrepreneurs">Entrepreneurs</option>
                        <option value="managers" aria-label="Managers et dirigeants">Managers et dirigeants</option>
                        <option value="students" aria-label="√âtudiants">√âtudiants</option>
                        <option value="recruiters" aria-label="Recruteurs RH">Recruteurs RH</option>
                    </select>
                    <div id="testAudience-help" class="field-help" role="tooltip" aria-hidden="false">
                        S√©lectionnez le type de professionnels que vous souhaitez cibler avec votre post
                    </div>
                </div>

                <div class="form-group">
                    <label for="testTone" id="testToneLabel">
                        Ton du message <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <select id="testTone" name="tone" required 
                            aria-describedby="testTone-help"
                            aria-required="true"
                            aria-invalid="false"
                            aria-label="Menu d√©roulant pour s√©lectionner le ton du message"
                            tabindex="0">
                        <option value="" aria-label="Option par d√©faut - Choisir un ton">Choisir un ton...</option>
                        <option value="professional" aria-label="Ton professionnel" selected>Professionnel</option>
                        <option value="inspirational" aria-label="Ton inspirant">Inspirant</option>
                        <option value="casual" aria-label="Ton d√©contract√©">D√©contract√©</option>
                        <option value="educational" aria-label="Ton √©ducatif">√âducatif</option>
                        <option value="motivational" aria-label="Ton motivant">Motivant</option>
                        <option value="thoughtful" aria-label="Ton r√©fl√©chi">R√©fl√©chi</option>
                    </select>
                    <div id="testTone-help" class="field-help" role="tooltip" aria-hidden="false">
                        D√©finissez l'ambiance et le style de votre message LinkedIn
                    </div>
                </div>

                <div class="form-group">
                    <label for="testLanguage" id="testLanguageLabel">
                        Langue du post <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <select id="testLanguage" name="postLanguage" required 
                            aria-describedby="testLanguage-help"
                            aria-required="true"
                            aria-invalid="false"
                            aria-label="Menu d√©roulant pour s√©lectionner la langue du post"
                            tabindex="0">
                        <option value="fr" aria-label="Fran√ßais" selected>Fran√ßais</option>
                        <option value="en" aria-label="English">English</option>
                    </select>
                    <div id="testLanguage-help" class="field-help" role="tooltip" aria-hidden="false">
                        Choisissez la langue dans laquelle votre post sera g√©n√©r√©
                    </div>
                </div>

                <div class="form-group">
                    <label for="testModel" id="testModelLabel">
                        Mod√®le IA <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <select id="testModel" name="ollamaModel" required 
                            aria-describedby="testModel-help"
                            aria-required="true"
                            aria-invalid="false"
                            aria-label="Menu d√©roulant pour s√©lectionner le mod√®le d'intelligence artificielle"
                            tabindex="0">
                        <option value="" aria-label="Option par d√©faut - Choisir un mod√®le">Choisir un mod√®le...</option>
                        <option value="llama2" aria-label="Mod√®le Llama 2" selected>Llama 2</option>
                        <option value="mistral" aria-label="Mod√®le Mistral">Mistral</option>
                        <option value="codellama" aria-label="Mod√®le Code Llama">Code Llama</option>
                    </select>
                    <div id="testModel-help" class="field-help" role="tooltip" aria-hidden="false">
                        S√©lectionnez le mod√®le d'intelligence artificielle qui g√©n√©rera votre post
                    </div>
                </div>

                <button type="submit" id="generateBtn" class="generate-btn" 
                        aria-describedby="testGenerate-help"
                        aria-label="Bouton de test pour g√©n√©rer un post LinkedIn"
                        tabindex="0">
                    <svg class="icon" aria-hidden="true">
                        <use href="#sparkles-icon"></use>
                    </svg>
                    <span id="generateBtnText">üß™ Tester la G√©n√©ration</span>
                </button>
                
                <div id="testGenerate-help" class="field-help" role="tooltip" aria-hidden="false">
                    Bouton de test pour v√©rifier le fonctionnement de la g√©n√©ration
                </div>
            </form>
        </div>

        <div class="test-section">
            <h2>üîç Tests Automatiques</h2>
            
            <button id="runTests" class="generate-btn" style="margin-bottom: 20px;">
                üöÄ Lancer les Tests de G√©n√©ration
            </button>
            
            <div id="testResults" class="test-results" style="display: none;">
                <h3>üìä R√©sultats des Tests</h3>
                <div id="testResultsContent"></div>
            </div>
        </div>

        <div class="test-section">
            <h2>üìù Instructions de Test Manuel</h2>
            
            <ol>
                <li><strong>Test de Validation :</strong> Essayez de soumettre le formulaire vide pour voir les erreurs</li>
                <li><strong>Test de Saisie :</strong> Remplissez tous les champs et soumettez le formulaire</li>
                <li><strong>Test d'√âtat :</strong> V√©rifiez que le bouton passe en mode "G√©n√©ration..."</li>
                <li><strong>Test de D√©sactivation :</strong> V√©rifiez que le bouton est d√©sactiv√© pendant la g√©n√©ration</li>
                <li><strong>Test de Restauration :</strong> V√©rifiez que le bouton revient √† son √©tat normal apr√®s</li>
                <li><strong>Test de Navigation :</strong> Utilisez Tab/Shift+Tab pour naviguer dans le formulaire</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h2>üêõ Informations de D√©bogage</h2>
            
            <div class="debug-info" id="debugInfo">
                <strong>Console de d√©bogage :</strong><br>
                Les informations de d√©bogage appara√Ætront ici...
            </div>
        </div>
    </div>

    <script>
        class GenerationTester {
            constructor() {
                this.form = document.getElementById('testForm');
                this.generateBtn = document.getElementById('generateBtn');
                this.runTestsBtn = document.getElementById('runTests');
                this.testResults = document.getElementById('testResults');
                this.testResultsContent = document.getElementById('testResultsContent');
                this.debugInfo = document.getElementById('debugInfo');
                
                this.originalBtnText = '';
                this.isGenerating = false;
                
                this.init();
            }
            
            init() {
                this.generateBtn.addEventListener('click', (e) => this.handleGenerate(e));
                this.runTestsBtn.addEventListener('click', () => this.runAllTests());
                this.form.addEventListener('submit', (e) => this.handleSubmit(e));
                
                // Tests automatiques au chargement
                setTimeout(() => this.runBasicTests(), 1000);
                
                this.log('üß™ Testeur de g√©n√©ration initialis√©');
            }
            
            log(message) {
                console.log(message);
                this.debugInfo.innerHTML += `<br>${new Date().toLocaleTimeString()}: ${message}`;
                this.debugInfo.scrollTop = this.debugInfo.scrollHeight;
            }
            
            runBasicTests() {
                this.log('üß™ Tests de base en cours...');
                this.testFormValidation();
                this.testButtonAccessibility();
                this.testFormStructure();
            }
            
            runAllTests() {
                this.log('üöÄ Lancement de tous les tests...');
                this.testResults.style.display = 'block';
                this.testResultsContent.innerHTML = '';
                
                const tests = [
                    { name: 'Validation du Formulaire', test: () => this.testFormValidation() },
                    { name: 'Accessibilit√© du Bouton', test: () => this.testButtonAccessibility() },
                    { name: 'Structure du Formulaire', test: () => this.testFormStructure() },
                    { name: '√âtats du Bouton', test: () => this.testButtonStates() },
                    { name: 'Gestion des Erreurs', test: () => this.testErrorHandling() },
                    { name: 'Simulation de G√©n√©ration', test: () => this.testGenerationSimulation() }
                ];
                
                tests.forEach((test, index) => {
                    setTimeout(() => {
                        const result = test.test();
                        this.displayTestResult(test.name, result);
                    }, index * 500);
                });
            }
            
            testFormValidation() {
                const fields = this.form.querySelectorAll('input, select, textarea');
                let validFields = 0;
                let totalFields = fields.length;
                
                fields.forEach(field => {
                    if (field.hasAttribute('required') && field.value.trim()) {
                        validFields++;
                    }
                });
                
                const isValid = validFields === totalFields;
                
                this.log(`üìù Validation: ${validFields}/${totalFields} champs valides`);
                
                return {
                    success: isValid,
                    score: validFields,
                    total: totalFields,
                    message: `${validFields}/${totalFields} champs sont valides`
                };
            }
            
            testButtonAccessibility() {
                const hasId = this.generateBtn.hasAttribute('id');
                const hasAriaLabel = this.generateBtn.hasAttribute('aria-label');
                const hasAriaDescribedby = this.generateBtn.hasAttribute('aria-describedby');
                const hasTabIndex = this.generateBtn.tabIndex >= 0;
                const isNotDisabled = !this.generateBtn.disabled;
                
                const accessible = hasId && hasAriaLabel && hasAriaDescribedby && hasTabIndex && isNotDisabled;
                
                this.log(`‚ôø Accessibilit√©: ${accessible ? 'OK' : 'Probl√®mes d√©tect√©s'}`);
                
                return {
                    success: accessible,
                    score: [hasId, hasAriaLabel, hasAriaDescribedby, hasTabIndex, isNotDisabled].filter(Boolean).length,
                    total: 5,
                    message: accessible ? 'Bouton enti√®rement accessible' : 'Probl√®mes d\'accessibilit√© d√©tect√©s'
                };
            }
            
            testFormStructure() {
                const hasForm = !!this.form;
                const hasSubmitButton = !!this.form.querySelector('button[type="submit"]');
                const hasRequiredFields = this.form.querySelectorAll('[required]').length > 0;
                const hasLabels = this.form.querySelectorAll('label').length > 0;
                
                const validStructure = hasForm && hasSubmitButton && hasRequiredFields && hasLabels;
                
                this.log(`üèóÔ∏è Structure: ${validStructure ? 'OK' : 'Probl√®mes d√©tect√©s'}`);
                
                return {
                    success: validStructure,
                    score: [hasForm, hasSubmitButton, hasRequiredFields, hasLabels].filter(Boolean).length,
                    total: 4,
                    message: validStructure ? 'Structure du formulaire valide' : 'Probl√®mes de structure d√©tect√©s'
                };
            }
            
            testButtonStates() {
                const canBeDisabled = this.generateBtn.disabled === false;
                const canBeEnabled = this.generateBtn.disabled === false;
                const hasClasses = this.generateBtn.classList.length > 0;
                
                const validStates = canBeDisabled && canBeEnabled && hasClasses;
                
                this.log(`üîÑ √âtats: ${validStates ? 'OK' : 'Probl√®mes d√©tect√©s'}`);
                
                return {
                    success: validStates,
                    score: [canBeDisabled, canBeEnabled, hasClasses].filter(Boolean).length,
                    total: 3,
                    message: validStates ? '√âtats du bouton g√©r√©s correctement' : 'Probl√®mes d\'√©tats d√©tect√©s'
                };
            }
            
            testErrorHandling() {
                // Test de gestion des erreurs
                try {
                    this.form.checkValidity();
                    const hasErrorHandling = true;
                    
                    this.log(`‚ùå Gestion d'erreurs: ${hasErrorHandling ? 'OK' : 'Probl√®mes d√©tect√©s'}`);
                    
                    return {
                        success: hasErrorHandling,
                        score: 1,
                        total: 1,
                        message: 'Gestion des erreurs en place'
                    };
                } catch (error) {
                    this.log(`‚ùå Erreur lors du test de gestion d'erreurs: ${error.message}`);
                    return {
                        success: false,
                        score: 0,
                        total: 1,
                        message: 'Erreur lors du test de gestion d\'erreurs'
                    };
                }
            }
            
            testGenerationSimulation() {
                // Simulation d'une g√©n√©ration
                this.log('üé≠ Simulation de g√©n√©ration...');
                
                return new Promise((resolve) => {
                    this.setLoadingState(true);
                    
                    setTimeout(() => {
                        this.setLoadingState(false);
                        
                        const simulationSuccess = true;
                        
                        this.log(`üé≠ Simulation: ${simulationSuccess ? 'R√©ussie' : '√âchou√©e'}`);
                        
                        resolve({
                            success: simulationSuccess,
                            score: 1,
                            total: 1,
                            message: 'Simulation de g√©n√©ration r√©ussie'
                        });
                    }, 2000);
                });
            }
            
            setLoadingState(isLoading) {
                this.log(`üîÑ Changement d'√©tat: ${isLoading ? 'Chargement' : 'Normal'}`);
                
                if (isLoading) {
                    if (!this.originalBtnText) {
                        this.originalBtnText = this.generateBtn.innerHTML;
                    }
                    
                    this.generateBtn.disabled = true;
                    this.generateBtn.classList.add('loading-state');
                    
                    this.generateBtn.innerHTML = `
                        <span class="loading-spinner"></span>
                        <span>G√©n√©ration...</span>
                    `;
                    
                    this.isGenerating = true;
                } else {
                    this.generateBtn.disabled = false;
                    this.generateBtn.classList.remove('loading-state');
                    
                    if (this.originalBtnText) {
                        this.generateBtn.innerHTML = this.originalBtnText;
                    }
                    
                    this.isGenerating = false;
                }
            }
            
            displayTestResult(testName, result) {
                const testItem = document.createElement('div');
                testItem.className = `test-item ${result.success ? 'success' : 'error'}`;
                
                const status = result.success ? '‚úÖ' : '‚ùå';
                testItem.innerHTML = `
                    <strong>${status} ${testName}</strong><br>
                    <span>${result.message}</span><br>
                    <small>Score: ${result.score}/${result.total}</small>
                `;
                
                this.testResultsContent.appendChild(testItem);
                
                // Animation d'apparition
                testItem.style.opacity = '0';
                testItem.style.transform = 'translateY(20px)';
                testItem.style.transition = 'all 0.3s ease';
                
                setTimeout(() => {
                    testItem.style.opacity = '1';
                    testItem.style.transform = 'translateY(0)';
                }, 100);
            }
            
            handleSubmit(e) {
                e.preventDefault();
                this.log('üìù Soumission du formulaire...');
                
                // Validation
                const formData = new FormData(this.form);
                const errors = [];
                
                if (!formData.get('subject')) errors.push('Sujet du post');
                if (!formData.get('audience')) errors.push('Audience cible');
                if (!formData.get('tone')) errors.push('Ton du message');
                if (!formData.get('postLanguage')) errors.push('Langue du post');
                if (!formData.get('ollamaModel')) errors.push('Mod√®le IA');
                
                if (errors.length > 0) {
                    this.log(`‚ùå Erreurs de validation: ${errors.join(', ')}`);
                    alert(`Veuillez remplir les champs suivants : ${errors.join(', ')}`);
                } else {
                    this.log('‚úÖ Formulaire valide, simulation de g√©n√©ration...');
                    this.simulateGeneration();
                }
            }
            
            handleGenerate(e) {
                e.preventDefault();
                this.log('üöÄ Clic sur le bouton de g√©n√©ration...');
                
                if (this.isGenerating) {
                    this.log('‚ö†Ô∏è G√©n√©ration d√©j√† en cours...');
                    return;
                }
                
                this.simulateGeneration();
            }
            
            simulateGeneration() {
                this.log('üé≠ D√©but de la simulation de g√©n√©ration...');
                
                // Simuler une g√©n√©ration
                this.setLoadingState(true);
                
                setTimeout(() => {
                    this.setLoadingState(false);
                    
                    // Simuler un r√©sultat
                    const mockPost = `üéØ Test de g√©n√©ration r√©ussi !

Ceci est un post de test g√©n√©r√© pour v√©rifier le bon fonctionnement du bouton de g√©n√©ration.

‚úÖ Tous les param√®tres ont √©t√© pris en compte :
- Sujet : ${document.getElementById('testSubject').value.substring(0, 50)}...
- Audience : ${document.getElementById('testAudience').value}
- Ton : ${document.getElementById('testTone').value}
- Langue : ${document.getElementById('testLanguage').value}
- Mod√®le : ${document.getElementById('testModel').value}

üöÄ Le bouton fonctionne correctement !

#Test #G√©n√©ration #LinkedIn #PostSocial #Accessibilit√©`;

                    this.log('‚úÖ Simulation termin√©e avec succ√®s');
                    this.displayMockResult(mockPost);
                    
                }, 3000);
            }
            
            displayMockResult(post) {
                const resultDiv = document.createElement('div');
                resultDiv.className = 'test-results';
                resultDiv.innerHTML = `
                    <h3>üé≠ R√©sultat de la Simulation</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; border: 1px solid #dee2e6; white-space: pre-wrap; font-family: monospace; max-height: 300px; overflow-y: auto;">
                        ${post}
                    </div>
                `;
                
                this.form.parentNode.insertBefore(resultDiv, this.form.nextSibling);
                
                // Faire d√©filer vers le r√©sultat
                resultDiv.scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // Initialiser le testeur
        document.addEventListener('DOMContentLoaded', () => {
            new GenerationTester();
        });
    </script>
</body>
</html>
