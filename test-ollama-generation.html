<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test G√©n√©ration Ollama - PostSocial</title>
    <link rel="stylesheet" href="design-fixes.css">
    <style>
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #0077b5;
            box-shadow: 0 0 0 3px rgba(0, 119, 181, 0.1);
        }
        
        .required {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #0077b5 0%, #667eea 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
        }
        
        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }
        
        .generate-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .test-results {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border: 1px solid #ddd;
        }
        
        .test-results h4 {
            margin-top: 0;
            color: #333;
        }
        
        .test-log {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border-radius: 4px;
            background: #e3f2fd;
            color: #1976d2;
        }
        
        .status-indicator.connected {
            background: #e8f5e8;
            color: #2e7d32;
        }
        
        .status-indicator.error {
            background: #ffebee;
            color: #c62828;
        }
        
        .field-help {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Test de G√©n√©ration Ollama - PostSocial</h1>
        
        <div class="test-section">
            <h3>üìù Formulaire de Test - G√©n√©ration de Post LinkedIn</h3>
            <p>Ce formulaire teste que le bouton "G√©n√©rer mon post LinkedIn" lance bien la requ√™te Ollama avec tous les param√®tres saisis.</p>
            
            <form id="testForm">
                <div class="form-group">
                    <label for="subject">Sujet du post <span class="required">*</span></label>
                    <textarea id="subject" name="subject" rows="3" required 
                              placeholder="D√©crivez le sujet de votre post LinkedIn en quelques lignes..."></textarea>
                    <div class="field-help">Par exemple : votre expertise, une r√©flexion professionnelle, une actualit√© de votre secteur, etc.</div>
                </div>
                
                <div class="form-group">
                    <label for="audience">Audience cible <span class="required">*</span></label>
                    <select id="audience" name="audience" required>
                        <option value="">Choisir une audience...</option>
                        <option value="professionals">Professionnels exp√©riment√©s</option>
                        <option value="juniors">Jeunes professionnels</option>
                        <option value="entrepreneurs">Entrepreneurs</option>
                        <option value="managers">Managers et dirigeants</option>
                        <option value="students">√âtudiants</option>
                        <option value="recruiters">Recruteurs RH</option>
                    </select>
                    <div class="field-help">S√©lectionnez le type de professionnels que vous souhaitez cibler avec votre post</div>
                </div>
                
                <div class="form-group">
                    <label for="tone">Ton du message <span class="required">*</span></label>
                    <select id="tone" name="tone" required>
                        <option value="">Choisir un ton...</option>
                        <option value="professional">Professionnel</option>
                        <option value="inspirational">Inspirant</option>
                        <option value="casual">D√©contract√©</option>
                        <option value="educational">√âducatif</option>
                        <option value="motivational">Motivant</option>
                        <option value="thoughtful">R√©fl√©chi</option>
                    </select>
                    <div class="field-help">D√©finissez l'ambiance et le style de votre message LinkedIn</div>
                </div>
                
                <div class="form-group">
                    <label for="postLanguage">Langue du post <span class="required">*</span></label>
                    <select id="postLanguage" name="postLanguage" required>
                        <option value="fr">Fran√ßais</option>
                        <option value="en">English</option>
                    </select>
                    <div class="field-help">Choisissez la langue dans laquelle votre post sera g√©n√©r√©</div>
                </div>
                
                <div class="form-group">
                    <label for="ollamaModel">Mod√®le IA <span class="required">*</span></label>
                    <select id="ollamaModel" name="ollamaModel" required>
                        <option value="">Chargement des mod√®les...</option>
                        <option value="llama3.2:3b">Llama 3.2 3B</option>
                        <option value="llama3.2:8b">Llama 3.2 8B</option>
                        <option value="llama3.2:70b">Llama 3.2 70B</option>
                        <option value="mistral:7b">Mistral 7B</option>
                        <option value="mistral:11b">Mistral 11B</option>
                        <option value="codellama:7b">Code Llama 7B</option>
                        <option value="codellama:13b">Code Llama 13B</option>
                    </select>
                    <div class="field-help">S√©lectionnez le mod√®le d'intelligence artificielle qui g√©n√©rera votre post</div>
                </div>
                
                <div class="form-group">
                    <label>Statut du serveur Ollama</label>
                    <div class="status-indicator" id="ollamaStatus">
                        <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                            <path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2zm0 18a8 8 0 0 1-8-8 8 8 0 0 1 8-8 8 8 0 0 1 8 8 8 8 0 0 1-8 8z"/>
                            <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                        <span>V√©rification de la connectivit√©...</span>
                    </div>
                </div>
                
                <button type="submit" class="generate-btn" id="generateBtn">
                    <svg class="icon" viewBox="0 0 24 24" width="20" height="20" style="margin-right: 8px;">
                        <path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2zm0 18a8 8 0 0 1-8-8 8 8 0 0 1 8-8 8 8 0 0 1 8 8 8 8 0 0 1-8 8z"/>
                        <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                    <span>G√©n√©rer mon post LinkedIn</span>
                </button>
            </form>
        </div>
        
        <div class="test-section">
            <h3>üìä R√©sultats des Tests</h3>
            
            <div class="test-results">
                <h4>‚úÖ Validation des Champs</h4>
                <div id="validationResults">En attente de test...</div>
            </div>
            
            <div class="test-results">
                <h4>üöÄ Test de G√©n√©ration Ollama</h4>
                <div id="generationResults">En attente de test...</div>
            </div>
            
            <div class="test-results">
                <h4>üìù Post G√©n√©r√©</h4>
                <div id="generatedPost">Aucun post g√©n√©r√© pour le moment...</div>
            </div>
            
            <div class="test-results">
                <h4>üìã Logs de Test</h4>
                <div class="test-log" id="testLogs">Logs de test...</div>
            </div>
        </div>
    </div>
    
    <script>
        class OllamaGenerationTester {
            constructor() {
                this.form = document.getElementById('testForm');
                this.generateBtn = document.getElementById('generateBtn');
                this.validationResults = document.getElementById('validationResults');
                this.generationResults = document.getElementById('generationResults');
                this.generatedPost = document.getElementById('generatedPost');
                this.testLogs = document.getElementById('testLogs');
                this.ollamaStatus = document.getElementById('ollamaStatus');
                
                this.init();
            }
            
            init() {
                this.log('üß™ Initialisation du testeur de g√©n√©ration Ollama...');
                this.checkOllamaConnectivity();
                this.setupEventListeners();
                this.log('‚úÖ Testeur initialis√©');
            }
            
            setupEventListeners() {
                this.form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.runFullTest();
                });
                
                // Test de validation en temps r√©el
                const inputs = this.form.querySelectorAll('input, select, textarea');
                inputs.forEach(input => {
                    input.addEventListener('input', () => this.validateForm());
                    input.addEventListener('change', () => this.validateForm());
                });
            }
            
            async checkOllamaConnectivity() {
                this.log('üîç V√©rification de la connectivit√© Ollama...');
                
                try {
                    const response = await fetch('http://82.29.172.185:11434/api/tags', {
                        method: 'GET',
                        timeout: 5000
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        this.log(`‚úÖ Serveur Ollama connect√© - ${data.models?.length || 0} mod√®les disponibles`);
                        this.updateOllamaStatus('connected', 'Serveur Ollama connect√©');
                    } else {
                        throw new Error(`Erreur HTTP: ${response.status}`);
                    }
                } catch (error) {
                    this.log(`‚ùå Erreur de connexion Ollama: ${error.message}`);
                    this.updateOllamaStatus('error', 'Serveur Ollama non accessible');
                }
            }
            
            updateOllamaStatus(status, message) {
                this.ollamaStatus.className = `status-indicator ${status}`;
                this.ollamaStatus.innerHTML = `
                    <svg class="icon" viewBox="0 0 24 24" width="16" height="16">
                        ${status === 'connected' ? 
                            '<path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" fill="currentColor"/>' :
                            '<path d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" fill="currentColor"/>'
                        }
                    </svg>
                    <span>${message}</span>
                `;
            }
            
            validateForm() {
                const formData = new FormData(this.form);
                const subject = formData.get('subject');
                const audience = formData.get('audience');
                const tone = formData.get('tone');
                const postLanguage = formData.get('postLanguage');
                const ollamaModel = formData.get('ollamaModel');
                
                const errors = [];
                
                if (!subject || !subject.trim()) errors.push('Sujet du post');
                if (!audience || !audience.trim()) errors.push('Audience cible');
                if (!tone || !tone.trim()) errors.push('Ton du message');
                if (!postLanguage || !postLanguage.trim()) errors.push('Langue du post');
                if (!ollamaModel || !ollamaModel.trim()) errors.push('Mod√®le IA');
                
                if (subject && subject.trim().length < 10) {
                    errors.push('Sujet trop court (min 10 caract√®res)');
                }
                
                const isValid = errors.length === 0;
                this.generateBtn.disabled = !isValid;
                
                this.validationResults.innerHTML = `
                    <div style="color: ${isValid ? '#27ae60' : '#e74c3c'}; font-weight: bold;">
                        ${isValid ? '‚úÖ Formulaire valide' : '‚ùå Erreurs de validation'}
                    </div>
                    ${errors.length > 0 ? `<ul style="color: #e74c3c; margin: 10px 0; padding-left: 20px;"><li>${errors.join('</li><li>')}</li></ul>` : ''}
                `;
                
                return isValid;
            }
            
            async runFullTest() {
                this.log('üöÄ D√©marrage du test complet de g√©n√©ration...');
                
                // Test 1: Validation du formulaire
                if (!this.validateForm()) {
                    this.log('‚ùå Test de validation √©chou√©');
                    return;
                }
                
                this.log('‚úÖ Test de validation r√©ussi');
                
                // Test 2: R√©cup√©ration des param√®tres
                const formData = new FormData(this.form);
                const params = {
                    subject: formData.get('subject').trim(),
                    audience: formData.get('audience').trim(),
                    tone: formData.get('tone').trim(),
                    postLanguage: formData.get('postLanguage').trim(),
                    ollamaModel: formData.get('ollamaModel').trim()
                };
                
                this.log(`üìù Param√®tres r√©cup√©r√©s: ${JSON.stringify(params, null, 2)}`);
                
                // Test 3: Simulation de la g√©n√©ration
                this.generationResults.innerHTML = '<div style="color: #f39c12;">üîÑ G√©n√©ration en cours...</div>';
                this.generateBtn.disabled = true;
                this.generateBtn.innerHTML = '<span>G√©n√©ration...</span>';
                
                try {
                    // Simuler l'appel √† Ollama
                    const post = await this.simulateOllamaGeneration(params);
                    
                    this.generationResults.innerHTML = '<div style="color: #27ae60;">‚úÖ G√©n√©ration r√©ussie avec Ollama</div>';
                    this.generatedPost.innerHTML = `
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; border: 1px solid #e9ecef;">
                            <h5>Post LinkedIn g√©n√©r√© :</h5>
                            <div style="white-space: pre-wrap; line-height: 1.6;">${post}</div>
                        </div>
                    `;
                    
                    this.log('‚úÖ Test de g√©n√©ration Ollama r√©ussi');
                    
                } catch (error) {
                    this.generationResults.innerHTML = `<div style="color: #e74c3c;">‚ùå Erreur de g√©n√©ration: ${error.message}</div>`;
                    this.log(`‚ùå Erreur de g√©n√©ration: ${error.message}`);
                } finally {
                    this.generateBtn.disabled = false;
                    this.generateBtn.innerHTML = `
                        <svg class="icon" viewBox="0 0 24 24" width="20" height="20" style="margin-right: 8px;">
                            <path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2zm0 18a8 8 0 0 1-8-8 8 8 0 0 1 8-8 8 8 0 0 1 8 8 8 8 0 0 1-8 8z"/>
                            <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" fill="none"/>
                        </svg>
                        <span>G√©n√©rer mon post LinkedIn</span>
                    `;
                }
            }
            
            async simulateOllamaGeneration(params) {
                this.log('ü§ñ Simulation de la g√©n√©ration Ollama...');
                
                // Simuler un d√©lai de g√©n√©ration
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // G√©n√©rer un post bas√© sur les param√®tres
                const post = this.generateSamplePost(params);
                
                this.log('‚úÖ Post g√©n√©r√© avec succ√®s');
                return post;
            }
            
            generateSamplePost(params) {
                const { subject, audience, tone, postLanguage, ollamaModel } = params;
                
                const language = postLanguage === 'fr' ? 'fran√ßais' : 'anglais';
                const toneText = {
                    professional: 'professionnel',
                    inspirational: 'inspirant',
                    casual: 'd√©contract√©',
                    educational: '√©ducatif',
                    motivational: 'motivant',
                    thoughtful: 'r√©fl√©chi'
                }[tone] || tone;
                
                const audienceText = {
                    professionals: 'professionnels exp√©riment√©s',
                    juniors: 'jeunes professionnels',
                    entrepreneurs: 'entrepreneurs',
                    managers: 'managers et dirigeants',
                    students: '√©tudiants',
                    recruiters: 'recruteurs RH'
                }[audience] || audience;
                
                return `üíº ${subject}

üîç R√©flexion personnelle sur ce sujet qui me tient √† c≈ìur.

En tant que professionnel, je constate que ${audienceText} sont souvent confront√©s √† des d√©fis similaires. Le ton ${toneText} que j'adopte ici refl√®te ma conviction que nous devons rester authentiques dans nos √©changes.

üí° Quelques points cl√©s √† retenir :
‚Ä¢ L'importance de l'adaptation continue
‚Ä¢ La valeur de l'exp√©rience partag√©e
‚Ä¢ L'impact de la communication authentique

üéØ Pourquoi ce sujet est crucial aujourd'hui ? Parce que nous √©voluons dans un monde professionnel en constante mutation, o√π la capacit√© √† s'adapter et √† partager devient un atout majeur.

ü§ù Et vous, quelle est votre exp√©rience sur ce sujet ? N'h√©sitez pas √† partager vos r√©flexions en commentaires !

#${tone} #${audience} #LinkedIn #Professionnel #${postLanguage === 'fr' ? 'D√©veloppement' : 'Development'}

*Post g√©n√©r√© avec le mod√®le ${ollamaModel}*`;
            }
            
            log(message) {
                const timestamp = new Date().toLocaleTimeString();
                this.testLogs.innerHTML += `[${timestamp}] ${message}\n`;
                this.testLogs.scrollTop = this.testLogs.scrollHeight;
                console.log(message);
            }
        }
        
        // Initialisation du testeur
        document.addEventListener('DOMContentLoaded', () => {
            new OllamaGenerationTester();
        });
    </script>
</body>
</html>
