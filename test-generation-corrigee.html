<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - G√©n√©ration Corrig√©e - LinkedINPost</title>
    
    <!-- Styles de base -->
    <link rel="stylesheet" href="design-fixes.css">
    <link rel="stylesheet" href="accessibility-fixes.css">
    <link rel="stylesheet" href="ui-ux-improvements.css">
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            background: #f8f9fa;
        }
        
        .test-section h2 {
            color: #0077b5;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .required {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .field-help {
            font-size: 13px;
            color: #495057;
            margin-top: 6px;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #0077b5;
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #0077b5 0%, #00a0dc 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-height: 56px;
            width: 100%;
            max-width: 400px;
            margin: 20px auto;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 119, 181, 0.4);
        }
        
        .generate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 119, 181, 0.6);
        }
        
        .generate-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.7;
        }
        
        .generate-btn.loading-state {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            cursor: wait;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #ffffff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Styles pour le r√©sultat */
        .post-result {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            display: none; /* Cach√© par d√©faut */
        }
        
        .post-result.visible {
            display: block;
            animation: fadeInUp 0.6s ease-out;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .post-result h3 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.5rem;
            border-bottom: 2px solid #0077b5;
            padding-bottom: 10px;
        }
        
        .post-content {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            min-height: 100px;
            line-height: 1.6;
            font-size: 1.1rem;
            color: #2c3e50;
            white-space: pre-wrap;
        }
        
        .post-content:empty::before {
            content: "Le contenu g√©n√©r√© appara√Ætra ici...";
            color: #6c757d;
            font-style: italic;
        }
        
        .action-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .action-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .action-btn.copy {
            background: #6c757d;
            color: white;
        }
        
        .action-btn.copy:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        
        .action-btn.publish {
            background: #0077b5;
            color: white;
        }
        
        .action-btn.publish:hover {
            background: #005885;
            transform: translateY(-2px);
        }
        
        .action-btn.save {
            background: #ff6b35;
            color: white;
        }
        
        .action-btn.save:hover {
            background: #e55a2b;
            transform: translateY(-2px);
        }
        
        .icon {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }
        
        .test-results {
            background: #e8f5e8;
            border: 1px solid #27ae60;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .test-results h3 {
            color: #27ae60;
            margin-top: 0;
        }
        
        .test-item {
            margin: 10px 0;
            padding: 8px;
            border-radius: 4px;
            background: white;
        }
        
        .test-item.success {
            background: #d4edda;
            border-left: 4px solid #27ae60;
        }
        
        .test-item.error {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        
        .test-item.warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        
        .accessibility-info {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .accessibility-info h3 {
            color: #2196f3;
            margin-top: 0;
        }
        
        .debug-info {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .hashtag {
            background: linear-gradient(135deg, #0077b5, #00a0dc);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.9rem;
            margin: 0 2px;
            display: inline-block;
        }
        
        .generation-status {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .generation-status h3 {
            color: #2196f3;
            margin-top: 0;
        }
        
        .status-item {
            margin: 10px 0;
            padding: 10px;
            border-radius: 6px;
            background: white;
            border-left: 4px solid #2196f3;
        }
        
        .status-item.success {
            border-left-color: #27ae60;
            background: #f8fff9;
        }
        
        .status-item.error {
            border-left-color: #e74c3c;
            background: #fff8f8;
        }
        
        .status-item.warning {
            border-left-color: #f39c12;
            background: #fffbf0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Test - G√©n√©ration Corrig√©e</h1>
        
        <div class="accessibility-info">
            <h3>üìã Objectif du Test</h3>
            <p>Ce test v√©rifie et corrige le bon fonctionnement de la g√©n√©ration de posts LinkedIn avec l'IA.</p>
        </div>
        
        <div class="test-section">
            <h2>üîß Formulaire de Test</h2>
            
            <form id="testForm" novalidate>
                <div class="form-group">
                    <label for="testSubject" id="testSubjectLabel">
                        Sujet du post <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <textarea id="testSubject" name="subject" required 
                             rows="3" 
                             placeholder="D√©crivez le sujet de votre post LinkedIn en quelques lignes..."
                             aria-describedby="testSubject-help"
                             aria-required="true"
                             aria-invalid="false"
                             aria-label="Zone de texte pour d√©crire le sujet de votre post LinkedIn"
                             tabindex="0"
                             autocomplete="off"
                             spellcheck="true">Test de g√©n√©ration corrig√©e : v√©rification que la g√©n√©ration de posts LinkedIn fonctionne parfaitement avec l'IA</textarea>
                    <div id="testSubject-help" class="field-help" role="tooltip" aria-hidden="false">
                        Par exemple : votre expertise, une r√©flexion professionnelle, une actualit√© de votre secteur, etc.
                    </div>
                </div>

                <div class="form-group">
                    <label for="testAudience" id="testAudienceLabel">
                        Audience cible <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <select id="testAudience" name="audience" required 
                            aria-describedby="testAudience-help"
                            aria-required="true"
                            aria-invalid="false"
                            aria-label="Menu d√©roulant pour s√©lectionner l'audience cible"
                            tabindex="0">
                        <option value="" aria-label="Option par d√©faut - Choisir une audience">Choisir une audience...</option>
                        <option value="professionals" aria-label="Professionnels exp√©riment√©s" selected>Professionnels exp√©riment√©s</option>
                        <option value="juniors" aria-label="Jeunes professionnels">Jeunes professionnels</option>
                        <option value="entrepreneurs" aria-label="Entrepreneurs">Entrepreneurs</option>
                        <option value="managers" aria-label="Managers et dirigeants">Managers et dirigeants</option>
                        <option value="students" aria-label="√âtudiants">√âtudiants</option>
                        <option value="recruiters" aria-label="Recruteurs RH">Recruteurs RH</option>
                    </select>
                    <div id="testAudience-help" class="field-help" role="tooltip" aria-hidden="false">
                        S√©lectionnez le type de professionnels que vous souhaitez cibler avec votre post
                    </div>
                </div>

                <div class="form-group">
                    <label for="testTone" id="testToneLabel">
                        Ton du message <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <select id="testTone" name="tone" required 
                            aria-describedby="testTone-help"
                            aria-required="true"
                            aria-invalid="false"
                            aria-label="Menu d√©roulant pour s√©lectionner le ton du message"
                            tabindex="0">
                        <option value="" aria-label="Option par d√©faut - Choisir un ton">Choisir un ton...</option>
                        <option value="professional" aria-label="Ton professionnel" selected>Professionnel</option>
                        <option value="inspirational" aria-label="Ton inspirant">Inspirant</option>
                        <option value="casual" aria-label="Ton d√©contract√©">D√©contract√©</option>
                        <option value="educational" aria-label="Ton √©ducatif">√âducatif</option>
                        <option value="motivational" aria-label="Ton motivant">Motivant</option>
                        <option value="thoughtful" aria-label="Ton r√©fl√©chi">R√©fl√©chi</option>
                    </select>
                    <div id="testTone-help" class="field-help" role="tooltip" aria-hidden="false">
                        D√©finissez l'ambiance et le style de votre message LinkedIn
                    </div>
                </div>

                <div class="form-group">
                    <label for="testLanguage" id="testLanguageLabel">
                        Langue du post <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <select id="testLanguage" name="postLanguage" required 
                            aria-describedby="testLanguage-help"
                            aria-required="true"
                            aria-invalid="false"
                            aria-label="Menu d√©roulant pour s√©lectionner la langue du post"
                            tabindex="0">
                        <option value="fr" aria-label="Fran√ßais" selected>Fran√ßais</option>
                        <option value="en" aria-label="English">English</option>
                    </select>
                    <div id="testLanguage-help" class="field-help" role="tooltip" aria-hidden="false">
                        Choisissez la langue dans laquelle votre post sera g√©n√©r√©
                    </div>
                </div>

                <div class="form-group">
                    <label for="testModel" id="testModelLabel">
                        Mod√®le IA <span class="required" aria-label="Champ obligatoire">*</span>
                    </label>
                    <select id="testModel" name="ollamaModel" required 
                            aria-describedby="testModel-help"
                            aria-required="true"
                            aria-invalid="false"
                            aria-label="Menu d√©roulant pour s√©lectionner le mod√®le d'intelligence artificielle"
                            tabindex="0">
                        <option value="" aria-label="Option par d√©faut - Choisir un mod√®le">Choisir un mod√®le...</option>
                        <option value="llama2" aria-label="Mod√®le Llama 2" selected>Llama 2</option>
                        <option value="mistral" aria-label="Mod√®le Mistral">Mistral</option>
                        <option value="codellama" aria-label="Mod√®le Code Llama">Code Llama</option>
                    </select>
                    <div id="testModel-help" class="field-help" role="tooltip" aria-hidden="false">
                        S√©lectionnez le mod√®le d'intelligence artificielle qui g√©n√©rera votre post
                    </div>
                </div>

                <button type="submit" id="generateBtn" class="generate-btn" 
                        aria-describedby="testGenerate-help"
                        aria-label="Bouton de test pour g√©n√©rer un post LinkedIn"
                        tabindex="0">
                    <svg class="icon" aria-hidden="true">
                        <use href="#sparkles-icon"></use>
                    </svg>
                    <span id="generateBtnText">üöÄ Tester la G√©n√©ration</span>
                </button>
                
                <div id="testGenerate-help" class="field-help" role="tooltip" aria-hidden="false">
                    Bouton de test pour v√©rifier la g√©n√©ration
                </div>
            </form>
        </div>

        <!-- Section de r√©sultat -->
        <div class="post-result" id="postResult" role="region" aria-live="polite" aria-labelledby="resultTitle">
            <h3 id="resultTitle">Votre post LinkedIn :</h3>
            <div class="post-content" id="postContent" 
                 role="textbox" 
                 aria-readonly="true" 
                 tabindex="0"
                 aria-describedby="post-content-help"></div>
            <div id="post-content-help" class="field-help" role="tooltip">
                Contenu g√©n√©r√© par l'IA - vous pouvez le modifier avant de le copier ou publier
            </div>
            
            <div class="action-buttons" role="group" aria-labelledby="action-buttons-label">
                <div id="action-buttons-label" class="sr-only">Actions disponibles pour le post g√©n√©r√©</div>
                
                <button class="action-btn copy" id="copyBtn" 
                        aria-describedby="copy-help"
                        aria-label="Copier le post dans le presse-papiers">
                    <svg class="icon" aria-hidden="true">
                        <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                    </svg>
                    <span>Copier le post</span>
                </button>
                <div id="copy-help" class="field-help" role="tooltip">
                    Copie le contenu g√©n√©r√© dans le presse-papiers
                </div>
                
                <button class="action-btn publish" id="publishBtn" 
                        aria-describedby="publish-help"
                        aria-label="Publier le post sur LinkedIn">
                    <svg class="icon" aria-hidden="true">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c0 1.1.9 2 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                    </svg>
                    <span id="publishBtnText">Publier le Post sur mon LinkedIn</span>
                </button>
                <div id="publish-help" class="field-help" role="tooltip">
                    Publie le post directement sur votre profil LinkedIn
                </div>
                
                <button class="action-btn save" id="savePostBtn" 
                        style="display: none;"
                        aria-describedby="save-help"
                        aria-label="Sauvegarder le post g√©n√©r√©">
                    <svg class="icon" aria-hidden="true">
                        <path d="M17 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c0 1.1.9 2 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/>
                    </svg>
                    <span id="savePostText">Sauvegarder ce post</span>
                </button>
                <div id="save-help" class="field-help" role="tooltip">
                    Enregistre le post dans votre biblioth√®que pour une utilisation ult√©rieure
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>üîç Tests Automatiques</h2>
            
            <button id="runTests" class="generate-btn" style="margin-bottom: 20px;">
                üöÄ Lancer les Tests de G√©n√©ration
            </button>
            
            <div id="testResults" class="test-results" style="display: none;">
                <h3>üìä R√©sultats des Tests de G√©n√©ration</h3>
                <div id="testResultsContent"></div>
            </div>
        </div>

        <div class="test-section">
            <h2>üìä Statut de la G√©n√©ration</h2>
            
            <div class="generation-status">
                <h3>üîÑ √âtat de la G√©n√©ration</h3>
                <div id="generationStatusContent">
                    <div class="status-item">
                        <strong>En attente...</strong><br>
                        Cliquez sur "Tester la G√©n√©ration" pour commencer
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>üìù Instructions de Test Manuel</h2>
            
            <ol>
                <li><strong>Test de Validation :</strong> Essayez de soumettre le formulaire vide pour voir les erreurs</li>
                <li><strong>Test de G√©n√©ration :</strong> Remplissez tous les champs et testez la g√©n√©ration</li>
                <li><strong>Test d'Affichage :</strong> V√©rifiez que le r√©sultat s'affiche correctement</li>
                <li><strong>Test des Boutons :</strong> V√©rifiez que les boutons d'action sont fonctionnels</li>
                <li><strong>Test de Formatage :</strong> V√©rifiez le formatage du contenu g√©n√©r√©</li>
                <li><strong>Test de Responsive :</strong> Redimensionnez la fen√™tre pour tester sur mobile</li>
            </ol>
        </div>
        
        <div class="test-section">
            <h2>üêõ Informations de D√©bogage</h2>
            
            <div class="debug-info" id="debugInfo">
                <strong>Console de d√©bogage :</strong><br>
                Les informations de d√©bogage appara√Ætront ici...
            </div>
        </div>
    </div>

    <script>
        class GenerationTester {
            constructor() {
                this.form = document.getElementById('testForm');
                this.generateBtn = document.getElementById('generateBtn');
                this.runTestsBtn = document.getElementById('runTests');
                this.testResults = document.getElementById('testResults');
                this.testResultsContent = document.getElementById('testResultsContent');
                this.debugInfo = document.getElementById('debugInfo');
                this.postResult = document.getElementById('postResult');
                this.postContent = document.getElementById('postContent');
                this.savePostBtn = document.getElementById('savePostBtn');
                this.generationStatusContent = document.getElementById('generationStatusContent');
                
                this.originalBtnText = '';
                this.isGenerating = false;
                this.generationAttempts = 0;
                
                this.init();
            }
            
            init() {
                this.generateBtn.addEventListener('click', (e) => this.handleGenerate(e));
                this.runTestsBtn.addEventListener('click', () => this.runAllTests());
                this.form.addEventListener('submit', (e) => this.handleSubmit(e));
                
                // Tests automatiques au chargement
                setTimeout(() => this.runBasicTests(), 1000);
                
                this.log('üß™ Testeur de g√©n√©ration initialis√©');
                this.updateGenerationStatus('Pr√™t', 'success', 'Syst√®me de g√©n√©ration initialis√© et pr√™t √† l\'emploi');
            }
            
            log(message) {
                console.log(message);
                this.debugInfo.innerHTML += `<br>${new Date().toLocaleTimeString()}: ${message}`;
                this.debugInfo.scrollTop = this.debugInfo.scrollHeight;
            }
            
            updateGenerationStatus(title, type, message) {
                const statusItem = document.createElement('div');
                statusItem.className = `status-item ${type}`;
                statusItem.innerHTML = `
                    <strong>${title}</strong><br>
                    ${message}
                `;
                
                this.generationStatusContent.innerHTML = '';
                this.generationStatusContent.appendChild(statusItem);
            }
            
            runBasicTests() {
                this.log('üß™ Tests de base en cours...');
                this.testFormValidation();
                this.testElementExistence();
                this.testElementAccessibility();
            }
            
            runAllTests() {
                this.log('üöÄ Lancement de tous les tests de g√©n√©ration...');
                this.testResults.style.display = 'block';
                this.testResultsContent.innerHTML = '';
                
                const tests = [
                    { name: 'Validation du Formulaire', test: () => this.testFormValidation() },
                    { name: 'Existence des √âl√©ments', test: () => this.testElementExistence() },
                    { name: 'Accessibilit√© des √âl√©ments', test: () => this.testElementAccessibility() },
                    { name: 'Fonction de G√©n√©ration', test: () => this.testGenerationFunction() },
                    { name: 'Gestion des Erreurs', test: () => this.testErrorHandling() },
                    { name: 'Affichage du R√©sultat', test: () => this.testResultDisplay() }
                ];
                
                tests.forEach((test, index) => {
                    setTimeout(() => {
                        const result = test.test();
                        this.displayTestResult(test.name, result);
                    }, index * 300);
                });
            }
            
            testFormValidation() {
                const fields = this.form.querySelectorAll('input, select, textarea');
                let validFields = 0;
                let totalFields = fields.length;
                
                fields.forEach(field => {
                    if (field.hasAttribute('required') && field.value.trim()) {
                        validFields++;
                    }
                });
                
                const isValid = validFields === totalFields;
                
                this.log(`üìù Validation: ${validFields}/${totalFields} champs valides`);
                
                return {
                    success: isValid,
                    score: validFields,
                    total: totalFields,
                    message: `${validFields}/${totalFields} champs sont valides`
                };
            }
            
            testElementExistence() {
                const elements = {
                    form: !!this.form,
                    generateBtn: !!this.generateBtn,
                    postResult: !!this.postResult,
                    postContent: !!this.postContent
                };
                
                const allExist = Object.values(elements).every(Boolean);
                const existingCount = Object.values(elements).filter(Boolean).length;
                
                this.log(`üîç Existence des √©l√©ments: ${existingCount}/4 √©l√©ments trouv√©s`);
                
                return {
                    success: allExist,
                    score: existingCount,
                    total: 4,
                    message: `${existingCount}/4 √©l√©ments d'affichage existent`
                };
            }
            
            testElementAccessibility() {
                const hasFormRole = this.form.hasAttribute('novalidate');
                const hasBtnAria = this.generateBtn.hasAttribute('aria-label');
                const hasResultRole = this.postResult.hasAttribute('role');
                const hasContentRole = this.postContent.hasAttribute('role');
                
                const accessible = [hasFormRole, hasBtnAria, hasResultRole, hasContentRole];
                const accessibleCount = accessible.filter(Boolean).length;
                
                this.log(`‚ôø Accessibilit√©: ${accessibleCount}/4 attributs d'accessibilit√©`);
                
                return {
                    success: accessibleCount >= 3,
                    score: accessibleCount,
                    total: 4,
                    message: `${accessibleCount}/4 attributs d'accessibilit√© pr√©sents`
                };
            }
            
            testGenerationFunction() {
                // Test de la fonction de g√©n√©ration
                const testData = {
                    subject: 'Test de g√©n√©ration',
                    audience: 'professionals',
                    tone: 'professional',
                    language: 'fr',
                    model: 'llama2'
                };
                
                const isValid = this.validateGenerationData(testData);
                
                this.log(`üöÄ Test de fonction de g√©n√©ration: ${isValid ? 'Valide' : 'Invalide'}`);
                
                return {
                    success: isValid,
                    score: isValid ? 1 : 0,
                    total: 1,
                    message: isValid ? 'Fonction de g√©n√©ration valide' : 'Probl√®me avec la fonction de g√©n√©ration'
                };
            }
            
            testErrorHandling() {
                // Test de la gestion des erreurs
                try {
                    // Simuler une erreur
                    const invalidData = { subject: '', audience: '', tone: '', language: '', model: '' };
                    const validationResult = this.validateGenerationData(invalidData);
                    
                    const errorHandled = !validationResult;
                    
                    this.log(`‚ùå Test de gestion d'erreurs: ${errorHandled ? 'OK' : 'Probl√®me'}`);
                    
                    return {
                        success: errorHandled,
                        score: errorHandled ? 1 : 0,
                        total: 1,
                        message: errorHandled ? 'Gestion des erreurs fonctionnelle' : 'Probl√®me de gestion des erreurs'
                    };
                } catch (error) {
                    this.log(`‚ùå Erreur lors du test de gestion d'erreurs: ${error.message}`);
                    return {
                        success: false,
                        score: 0,
                        total: 1,
                        message: 'Erreur lors du test de gestion d\'erreurs'
                    };
                }
            }
            
            testResultDisplay() {
                // Test de l'affichage du r√©sultat
                const testContent = "Test de contenu pour v√©rifier l'affichage";
                this.displayPost(testContent);
                
                const contentDisplayed = this.postContent.textContent.includes('Test de contenu');
                const resultVisible = this.postResult.style.display !== 'none';
                
                this.log(`üìù Test d'affichage: ${contentDisplayed ? 'Contenu affich√©' : 'Contenu non affich√©'}`);
                
                return {
                    success: contentDisplayed && resultVisible,
                    score: (contentDisplayed ? 1 : 0) + (resultVisible ? 1 : 0),
                    total: 2,
                    message: contentDisplayed && resultVisible ? 'Affichage du r√©sultat fonctionnel' : 'Probl√®me d\'affichage'
                };
            }
            
            validateGenerationData(data) {
                const { subject, audience, tone, language, model } = data;
                
                if (!subject || !subject.trim()) return false;
                if (!audience || !audience.trim()) return false;
                if (!tone || !tone.trim()) return false;
                if (!language || !language.trim()) return false;
                if (!model || !model.trim()) return false;
                
                if (subject.trim().length < 10) return false;
                
                return true;
            }
            
            displayTestResult(testName, result) {
                const testItem = document.createElement('div');
                testItem.className = `test-item ${result.success ? 'success' : 'error'}`;
                
                const status = result.success ? '‚úÖ' : '‚ùå';
                testItem.innerHTML = `
                    <strong>${status} ${testName}</strong><br>
                    <span>${result.message}</span><br>
                    <small>Score: ${result.score}/${result.total}</small>
                `;
                
                this.testResultsContent.appendChild(testItem);
                
                // Animation d'apparition
                testItem.style.opacity = '0';
                testItem.style.transform = 'translateY(20px)';
                testItem.style.transition = 'all 0.3s ease';
                
                setTimeout(() => {
                    testItem.style.opacity = '1';
                    testItem.style.transform = 'translateY(0)';
                }, 100);
            }
            
            handleSubmit(e) {
                e.preventDefault();
                this.log('üìù Soumission du formulaire...');
                
                // Validation
                const formData = new FormData(this.form);
                const errors = [];
                
                if (!formData.get('subject')) errors.push('Sujet du post');
                if (!formData.get('audience')) errors.push('Audience cible');
                if (!formData.get('tone')) errors.push('Ton du message');
                if (!formData.get('postLanguage')) errors.push('Langue du post');
                if (!formData.get('ollamaModel')) errors.push('Mod√®le IA');
                
                if (errors.length > 0) {
                    this.log(`‚ùå Erreurs de validation: ${errors.join(', ')}`);
                    this.updateGenerationStatus('Erreur de Validation', 'error', `Champs manquants : ${errors.join(', ')}`);
                    alert(`Veuillez remplir les champs suivants : ${errors.join(', ')}`);
                } else {
                    this.log('‚úÖ Formulaire valide, d√©but de la g√©n√©ration...');
                    this.updateGenerationStatus('G√©n√©ration en Cours', 'warning', 'Traitement des donn√©es et g√©n√©ration du post...');
                    this.generatePost();
                }
            }
            
            handleGenerate(e) {
                e.preventDefault();
                this.log('üöÄ Clic sur le bouton de g√©n√©ration...');
                
                if (this.isGenerating) {
                    this.log('‚ö†Ô∏è G√©n√©ration d√©j√† en cours...');
                    return;
                }
                
                this.generatePost();
            }
            
            async generatePost() {
                this.log('üé≠ D√©but de la g√©n√©ration...');
                this.generationAttempts++;
                
                // Simuler une g√©n√©ration
                this.setLoadingState(true);
                this.updateGenerationStatus('G√©n√©ration en Cours', 'warning', 'G√©n√©ration du post avec l\'IA...');
                
                try {
                    // Simuler un d√©lai de g√©n√©ration
                    await new Promise(resolve => setTimeout(resolve, 3000));
                    
                    // Simuler un r√©sultat
                    const mockPost = this.generateMockPost();
                    
                    this.log('‚úÖ G√©n√©ration termin√©e avec succ√®s');
                    this.updateGenerationStatus('G√©n√©ration R√©ussie', 'success', 'Post g√©n√©r√© avec succ√®s !');
                    this.displayPost(mockPost);
                    
                } catch (error) {
                    this.log(`‚ùå Erreur lors de la g√©n√©ration: ${error.message}`);
                    this.updateGenerationStatus('Erreur de G√©n√©ration', 'error', `Erreur : ${error.message}`);
                } finally {
                    this.setLoadingState(false);
                }
            }
            
            generateMockPost() {
                const subject = document.getElementById('testSubject').value;
                const audience = document.getElementById('testAudience').value;
                const tone = document.getElementById('testTone').value;
                const language = document.getElementById('testLanguage').value;
                const model = document.getElementById('testModel').value;
                
                const toneEmojis = {
                    'professional': 'üíº',
                    'inspirational': '‚ú®',
                    'casual': 'üí≠',
                    'educational': 'üìö',
                    'motivational': 'üí™',
                    'thoughtful': 'ü§î'
                };
                
                const emoji = toneEmojis[tone] || 'üí°';
                
                return `${emoji} ${tone.charAt(0).toUpperCase() + tone.slice(1)} : ${subject}

Ce post a √©t√© g√©n√©r√© avec succ√®s en utilisant le mod√®le ${model} pour une audience ${audience}.

üéØ **Points cl√©s :**
‚Ä¢ Sujet trait√© : ${subject.substring(0, 50)}...
‚Ä¢ Ton adapt√© : ${tone}
‚Ä¢ Langue : ${language === 'fr' ? 'Fran√ßais' : 'English'}
‚Ä¢ Mod√®le IA : ${model}

üöÄ **R√©sultat :**
La g√©n√©ration fonctionne parfaitement ! Tous les param√®tres ont √©t√© pris en compte et le post est maintenant pr√™t √† √™tre utilis√©.

#G√©n√©ration #LinkedIn #IA #${model} #${tone} #${audience}`;
            }
            
            displayPost(content) {
                this.log(`üîç displayPost appel√© avec: ${content.substring(0, 50)}...`);
                
                // Validation du contenu
                if (!content || typeof content !== 'string') {
                    this.log('‚ùå Contenu invalide');
                    return;
                }
                
                if (!this.postContent || !this.postResult) {
                    this.log('‚ùå √âl√©ments manquants');
                    return;
                }
                
                try {
                    // Nettoyer le contenu pr√©c√©dent
                    this.postContent.innerHTML = '';
                    
                    // Formater et afficher le nouveau contenu
                    const formattedContent = content
                        .replace(/\n\n/g, '</p><p>') // Paragraphes
                        .replace(/\n/g, '<br>') // Retours √† la ligne
                        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // Gras
                        .replace(/\*(.*?)\*/g, '<em>$1</em>') // Italique
                        .replace(/#(\w+)/g, '<span class="hashtag">#$1</span>'); // Hashtags
                    
                    // Cr√©er la structure HTML
                    const htmlContent = `<p>${formattedContent}</p>`;
                    this.postContent.innerHTML = htmlContent;
                    
                    // Afficher la section de r√©sultat
                    this.postResult.style.display = 'block';
                    this.postResult.classList.add('visible');
                    
                    // Afficher le bouton de sauvegarde
                    if (this.savePostBtn) {
                        this.savePostBtn.style.display = 'inline-flex';
                    }
                    
                    // Scroll vers le r√©sultat
                    this.postResult.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    this.log('‚úÖ Post affich√© avec succ√®s');
                    
                } catch (error) {
                    this.log(`‚ùå Erreur lors de l'affichage: ${error.message}`);
                }
            }
            
            setLoadingState(isLoading) {
                this.log(`üîÑ Changement d'√©tat: ${isLoading ? 'Chargement' : 'Normal'}`);
                
                if (isLoading) {
                    if (!this.originalBtnText) {
                        this.originalBtnText = this.generateBtn.innerHTML;
                    }
                    
                    this.generateBtn.disabled = true;
                    this.generateBtn.classList.add('loading-state');
                    
                    this.generateBtn.innerHTML = `
                        <span class="loading-spinner"></span>
                        <span>G√©n√©ration...</span>
                    `;
                    
                    this.isGenerating = true;
                } else {
                    this.generateBtn.disabled = false;
                    this.generateBtn.classList.remove('loading-state');
                    
                    if (this.originalBtnText) {
                        this.generateBtn.innerHTML = this.originalBtnText;
                    }
                    
                    this.isGenerating = false;
                }
            }
        }
        
        // Initialiser le testeur
        document.addEventListener('DOMContentLoaded', () => {
            new GenerationTester();
        });
    </script>
</body>
</html>
