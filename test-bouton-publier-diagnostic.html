<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnostic - Bouton Publier Non-Cliquable</title>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .diagnostic-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            background: #f8f9fa;
        }
        
        .diagnostic-section h2 {
            color: #0077b5;
            margin-bottom: 15px;
        }
        
        .test-btn {
            background: #0077b5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px 10px 10px 0;
            transition: all 0.3s ease;
        }
        
        .test-btn:hover {
            background: #005885;
            transform: translateY(-1px);
        }
        
        .publish-btn {
            background: linear-gradient(135deg, #0077b5 0%, #00a0dc 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 20px auto;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 119, 181, 0.4);
        }
        
        .publish-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 119, 181, 0.6);
        }
        
        .publish-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.6;
            pointer-events: none;
        }
        
        .publish-btn.active {
            opacity: 1;
            cursor: pointer;
            pointer-events: auto;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .status-item {
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #0077b5;
            background: white;
        }
        
        .status-item.success {
            border-left-color: #27ae60;
            background: #f8fff9;
        }
        
        .status-item.error {
            border-left-color: #e74c3c;
            background: #fff8f8;
        }
        
        .status-item.warning {
            border-left-color: #f39c12;
            background: #fffbf0;
        }
        
        .logs {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 15px 0;
        }
        
        .post-content {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            min-height: 100px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß Diagnostic - Bouton Publier Non-Cliquable</h1>
        
        <div class="diagnostic-section">
            <h2>üß™ Tests d'Activation du Bouton</h2>
            
            <button class="test-btn" onclick="simulatePostGeneration()">
                üìù Simuler G√©n√©ration de Post
            </button>
            
            <button class="test-btn" onclick="diagnosticButtonState()">
                üîç Diagnostiquer √âtat du Bouton
            </button>
            
            <button class="test-btn" onclick="forceActivateButton()">
                ‚ö° Forcer Activation
            </button>
            
            <button class="test-btn" onclick="testClickEvent()">
                üñ±Ô∏è Tester √âv√©nement Click
            </button>
        </div>

        <div class="diagnostic-section">
            <h2>üìä √âtat du Bouton en Temps R√©el</h2>
            
            <div class="status-grid" id="statusGrid">
                <div class="status-item" id="existenceStatus">
                    <strong>Existence:</strong> <span id="existenceValue">-</span>
                </div>
                <div class="status-item" id="visibilityStatus">
                    <strong>Visibilit√©:</strong> <span id="visibilityValue">-</span>
                </div>
                <div class="status-item" id="disabledStatus">
                    <strong>Disabled:</strong> <span id="disabledValue">-</span>
                </div>
                <div class="status-item" id="pointerEventsStatus">
                    <strong>Pointer Events:</strong> <span id="pointerEventsValue">-</span>
                </div>
                <div class="status-item" id="opacityStatus">
                    <strong>Opacit√©:</strong> <span id="opacityValue">-</span>
                </div>
                <div class="status-item" id="classesStatus">
                    <strong>Classes:</strong> <span id="classesValue">-</span>
                </div>
            </div>
        </div>

        <div class="diagnostic-section">
            <h2>üìù Post de Test</h2>
            
            <div class="post-content" id="postContent">
                Aucun contenu g√©n√©r√©. Cliquez sur "Simuler G√©n√©ration de Post" pour cr√©er du contenu de test.
            </div>
            
            <!-- Bouton de publication LinkedIn (copie conforme) -->
            <div class="publish-section" style="margin-top: 2rem; text-align: center;">
                <button class="publish-btn" id="publishLinkedInBtn" 
                        style="display: none;"
                        aria-describedby="publish-help"
                        aria-label="Publier le post sur votre profil LinkedIn">
                    <svg class="icon" viewBox="0 0 24 24" aria-hidden="true" style="width: 20px; height: 20px; fill: currentColor;">
                        <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                    </svg>
                    <span id="publishBtnText">Publier le Post sur votre LinkedIn</span>
                </button>
            </div>
        </div>

        <div class="diagnostic-section">
            <h2>üìã Logs de Diagnostic</h2>
            <div class="logs" id="diagnosticLogs">
                Console de diagnostic initialis√©e...<br>
            </div>
        </div>
    </div>

    <script>
        class PublishButtonDiagnostic {
            constructor() {
                this.publishBtn = document.getElementById('publishLinkedInBtn');
                this.postContent = document.getElementById('postContent');
                this.logs = document.getElementById('diagnosticLogs');
                
                this.init();
            }
            
            init() {
                this.log('üöÄ Diagnostic du bouton Publier initialis√©');
                this.attachEventListener();
                this.startRealTimeMonitoring();
                this.updateStatus();
            }
            
            log(message) {
                const timestamp = new Date().toLocaleTimeString();
                console.log(message);
                this.logs.innerHTML += `[${timestamp}] ${message}<br>`;
                this.logs.scrollTop = this.logs.scrollHeight;
            }
            
            attachEventListener() {
                if (this.publishBtn) {
                    this.publishBtn.addEventListener('click', (e) => {
                        this.log('üéØ CLICK D√âTECT√â sur le bouton Publier !');
                        this.log(`Event details: target=${e.target.tagName}, currentTarget=${e.currentTarget.tagName}`);
                        this.simulatePublish();
                    });
                    this.log('‚úÖ Event listener attach√© au bouton');
                } else {
                    this.log('‚ùå Bouton non trouv√© pour attacher l\'event listener');
                }
            }
            
            simulatePublish() {
                this.log('üì§ Simulation de publication LinkedIn...');
                
                // Simuler l'√©tat de publication
                this.setPublishingState(true);
                
                setTimeout(() => {
                    this.setPublishingState(false);
                    this.log('‚úÖ Publication simul√©e termin√©e avec succ√®s');
                    alert('‚úÖ Publication simul√©e r√©ussie !');
                }, 2000);
            }
            
            setPublishingState(isPublishing) {
                if (!this.publishBtn) return;
                
                if (isPublishing) {
                    this.originalText = this.publishBtn.innerHTML;
                    this.publishBtn.disabled = true;
                    this.publishBtn.innerHTML = `
                        <span style="display: inline-block; width: 20px; height: 20px; border: 2px solid #ffffff; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite;"></span>
                        <span>Publication...</span>
                    `;
                } else {
                    this.publishBtn.disabled = false;
                    this.publishBtn.innerHTML = this.originalText;
                }
            }
            
            simulatePostGeneration() {
                this.log('üìù Simulation de g√©n√©ration de post...');
                
                // G√©n√©rer du contenu de test
                const testContent = `üöÄ **Innovation et IA : Le futur de la vaccination**

En tant que professionnel de la sant√© publique, je suis fascin√© par l'impact transformateur de l'intelligence artificielle sur nos campagnes de vaccination.

üîç **Comment l'IA r√©volutionne la vaccination :**
‚Ä¢ Pr√©diction des besoins en vaccins avec une pr√©cision de 95%
‚Ä¢ Optimisation des cha√Ænes logistiques pour une distribution efficace
‚Ä¢ Identification des populations √† risque pour un ciblage pr√©cis

üí° **Mon exp√©rience personnelle :**
L'impl√©mentation de l'IA dans notre programme de vaccination a permis d'augmenter notre taux de couverture de 23% en seulement 6 mois.

#IA #Sant√©Publique #Innovation`;
                
                // Afficher le contenu
                this.postContent.innerHTML = testContent.replace(/\n/g, '<br>');
                
                // Activer le bouton comme le ferait l'app principale
                this.enablePublishButton();
                
                this.log('‚úÖ Post de test g√©n√©r√© et bouton activ√©');
                this.updateStatus();
            }
            
            enablePublishButton() {
                if (!this.publishBtn) return;
                
                this.log('üîß Activation du bouton Publier...');
                
                // Appliquer tous les styles d'activation
                this.publishBtn.style.display = 'inline-flex';
                this.publishBtn.disabled = false;
                this.publishBtn.classList.remove('disabled');
                this.publishBtn.classList.add('active');
                this.publishBtn.style.pointerEvents = 'auto';
                this.publishBtn.style.opacity = '1';
                this.publishBtn.style.cursor = 'pointer';
                
                this.log('‚úÖ Bouton activ√© avec tous les styles appliqu√©s');
            }
            
            disablePublishButton() {
                if (!this.publishBtn) return;
                
                this.log('üîß D√©sactivation du bouton Publier...');
                
                this.publishBtn.style.display = 'none';
                this.publishBtn.disabled = true;
                this.publishBtn.classList.add('disabled');
                this.publishBtn.classList.remove('active');
                this.publishBtn.style.pointerEvents = 'none';
                
                this.log('‚úÖ Bouton d√©sactiv√©');
            }
            
            diagnosticButtonState() {
                this.log('üîç === DIAGNOSTIC COMPLET DU BOUTON ===');
                
                if (!this.publishBtn) {
                    this.log('‚ùå ERREUR: Bouton non trouv√© dans le DOM');
                    return;
                }
                
                const computedStyle = window.getComputedStyle(this.publishBtn);
                
                this.log(`üìç Element trouv√©: ${this.publishBtn.tagName}#${this.publishBtn.id}`);
                this.log(`üéØ Display: ${computedStyle.display}`);
                this.log(`üîí Disabled: ${this.publishBtn.disabled}`);
                this.log(`üëÜ Pointer Events: ${computedStyle.pointerEvents}`);
                this.log(`üëÅÔ∏è Opacity: ${computedStyle.opacity}`);
                this.log(`üè∑Ô∏è Classes: ${this.publishBtn.className}`);
                this.log(`üìê Position: ${computedStyle.position}`);
                this.log(`üìè Z-Index: ${computedStyle.zIndex}`);
                this.log(`üñ±Ô∏è Cursor: ${computedStyle.cursor}`);
                
                // V√©rifier les event listeners
                const hasClick = this.publishBtn.onclick !== null;
                this.log(`üéß Event onclick: ${hasClick}`);
                
                // Tester la cliquabilit√©
                const rect = this.publishBtn.getBoundingClientRect();
                this.log(`üì¶ BoundingRect: ${rect.width}x${rect.height} at (${rect.left}, ${rect.top})`);
                
                // V√©rifier si un √©l√©ment est au-dessus
                const elementAtCenter = document.elementFromPoint(
                    rect.left + rect.width / 2,
                    rect.top + rect.height / 2
                );
                
                if (elementAtCenter === this.publishBtn) {
                    this.log('‚úÖ Bouton accessible au centre de sa zone');
                } else {
                    this.log(`‚ö†Ô∏è √âl√©ment diff√©rent au centre: ${elementAtCenter?.tagName}#${elementAtCenter?.id}`);
                }
                
                this.updateStatus();
            }
            
            forceActivateButton() {
                this.log('‚ö° FOR√áAGE de l\'activation du bouton...');
                
                if (!this.publishBtn) {
                    this.log('‚ùå Impossible: bouton non trouv√©');
                    return;
                }
                
                // Supprimer tous les styles bloquants
                this.publishBtn.style.cssText = `
                    display: inline-flex !important;
                    pointer-events: auto !important;
                    opacity: 1 !important;
                    cursor: pointer !important;
                    background: linear-gradient(135deg, #0077b5 0%, #00a0dc 100%) !important;
                    color: white !important;
                    border: none !important;
                    padding: 15px 30px !important;
                    border-radius: 50px !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    align-items: center !important;
                    justify-content: center !important;
                    gap: 10px !important;
                    margin: 20px auto !important;
                    transition: all 0.3s ease !important;
                    box-shadow: 0 4px 15px rgba(0, 119, 181, 0.4) !important;
                    z-index: 9999 !important;
                    position: relative !important;
                `;
                
                this.publishBtn.disabled = false;
                this.publishBtn.classList.remove('disabled');
                this.publishBtn.classList.add('active');
                
                this.log('‚úÖ Bouton forc√© en mode actif avec !important');
                this.updateStatus();
            }
            
            testClickEvent() {
                this.log('üñ±Ô∏è Test direct de l\'√©v√©nement click...');
                
                if (!this.publishBtn) {
                    this.log('‚ùå Bouton non trouv√©');
                    return;
                }
                
                try {
                    // Cr√©er un √©v√©nement click synth√©tique
                    const clickEvent = new MouseEvent('click', {
                        view: window,
                        bubbles: true,
                        cancelable: true
                    });
                    
                    this.log('üì§ Dispatch de l\'√©v√©nement click...');
                    const result = this.publishBtn.dispatchEvent(clickEvent);
                    this.log(`üì® √âv√©nement dispatch√©, r√©sultat: ${result}`);
                    
                } catch (error) {
                    this.log(`‚ùå Erreur lors du test click: ${error.message}`);
                }
            }
            
            updateStatus() {
                if (!this.publishBtn) {
                    this.setStatusItem('existence', 'error', 'Non trouv√©');
                    return;
                }
                
                const computedStyle = window.getComputedStyle(this.publishBtn);
                
                this.setStatusItem('existence', 'success', 'Trouv√©');
                this.setStatusItem('visibility', 
                    computedStyle.display === 'none' ? 'error' : 'success', 
                    computedStyle.display
                );
                this.setStatusItem('disabled', 
                    this.publishBtn.disabled ? 'error' : 'success', 
                    this.publishBtn.disabled ? 'Oui' : 'Non'
                );
                this.setStatusItem('pointerEvents', 
                    computedStyle.pointerEvents === 'none' ? 'error' : 'success', 
                    computedStyle.pointerEvents
                );
                this.setStatusItem('opacity', 
                    parseFloat(computedStyle.opacity) < 0.5 ? 'warning' : 'success', 
                    computedStyle.opacity
                );
                this.setStatusItem('classes', 'success', this.publishBtn.className || 'Aucune');
            }
            
            setStatusItem(type, status, value) {
                const element = document.getElementById(`${type}Status`);
                const valueElement = document.getElementById(`${type}Value`);
                
                if (element && valueElement) {
                    element.className = `status-item ${status}`;
                    valueElement.textContent = value;
                }
            }
            
            startRealTimeMonitoring() {
                // Mettre √† jour le statut toutes les 2 secondes
                setInterval(() => {
                    this.updateStatus();
                }, 2000);
            }
        }
        
        // Fonctions globales pour les boutons
        function simulatePostGeneration() {
            window.diagnostic.simulatePostGeneration();
        }
        
        function diagnosticButtonState() {
            window.diagnostic.diagnosticButtonState();
        }
        
        function forceActivateButton() {
            window.diagnostic.forceActivateButton();
        }
        
        function testClickEvent() {
            window.diagnostic.testClickEvent();
        }
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', () => {
            window.diagnostic = new PublishButtonDiagnostic();
        });
    </script>
    
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</body>
</html>
